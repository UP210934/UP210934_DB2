CREATE TABLE MOVIES 
   ("TITLE_ID" NUMBER(10) CONSTRAINT "FLX_MOV_MEDIAID_NN" NOT NULL , 
      "TITLE" VARCHAR2(60) CONSTRAINT "FLX_MOV_TITLE_NN" NOT NULL , 
      "DESCRIPTION" VARCHAR2(400) CONSTRAINT "FLX_MOV_DESCRIPTION_NN" NOT NULL , 
       "RATING" VARCHAR2(4), 
         "CATEGORY" VARCHAR2(20), 
           "RELEASE_DATE" DATE CONSTRAINT "FLX_MOV_RELDATE_NN" NOT NULL , 

      CONSTRAINT "FLX_MOV_TITLE_ID_PK" PRIMARY KEY ("TITLE_ID"),
      CONSTRAINT "FXL_MOV_CHECK_RATING" check(
            RATING IN ('G', 'PG', 'PG13', 'R')),
      CONSTRAINT "FXL_MOV_CHECK_CATEGORY" check(
            CATEGORY IN ('DRAMA', 'COMEDY', 'ACTION', 'CHILD', 
                        'SCIFI', 'DOCUMENTARY'))
USING INDEX ENABLE
);





CREATE TABLE STAR_BILLINGS 
     ("ACTOR_ID" NUMBER(10) CONSTRAINT "FLX_STB_ACTORID_NN" NOT NULL, 
      "TITLE_ID" NUMBER(10) CONSTRAINT "FLX_STB_TITLE_NN" NOT NULL, 
      "COMMENTS" VARCHAR2(40), 
      CONSTRAINT "FLX_STBILL_PK" PRIMARY KEY ("ACTOR_ID","TITLE_ID")
      USING INDEX ENABLE
   );



--Crear tabla Actors


CREATE TABLE  ACTORS 
   ("ACTOR_ID" NUMBER(10,0), 
	"STAGE_NAME" VARCHAR2(40)CONSTRAINT "STAGE_NAME_NN" NOT NULL , 
	"FIRST_NAME" VARCHAR2(25)CONSTRAINT "FIRST_NAME_NN" NOT NULL ,
    "LAST_NAME" VARCHAR2(25)CONSTRAINT "LAST_NAME_NN" NOT NULL ,
    "BIRTH_DATE" DATE CONSTRAINT "BIRTH_DATE_NN" NOT NULL ,
	CONSTRAINT "ACTOR_ID_PK" PRIMARY KEY ("ACTOR_ID")
	USING INDEX  ENABLE
   );



--crear tabla customers
CREATE TABLE "CUSTOMERS"
	("CUSTOMER_ID" NUMBER(10,0),
	"LAST_NAME" VARCHAR2(25) CONSTRAINT "FLX_CUST_LAST_NAME_NN" NOT NULL,
	"FIRST_NAME" VARCHAR2(25) CONSTRAINT "FLX_CUST_FIRST_NAME_NN" NOT NULL, 
	"HOME_PHONE" VARCHAR2(12) CONSTRAINT "FLX_CUST_HOME_PHONE_NN" NOT NULL,
	"ADDRESS" VARCHAR2(100) CONSTRAINT "FLX_CUST_ADD_NN" NOT NULL,
	"CITY" VARCHAR2(30) CONSTRAINT "FLX_CUST_CITY_NN" NOT NULL,
	"STATE" VARCHAR2(2) CONSTRAINT "FLX_CUST_STATE_NN" NOT NULL,
	"EMAIL" VARCHAR2(25),
	"CELL_PHONE" VARCHAR2(12),
	CONSTRAINT "FLX_CUST_ID_PK" PRIMARY KEY ("CUSTOMER_ID")
	USING INDEX ENABLE	
);

--crear tabla MEDIA
CREATE TABLE MEDIA
	("MEDIA_ID" NUMBER(10,0),
		"FORMAT" VARCHAR2(3) CONSTRAINT "FLX_MEDIA_FORM_NN" NOT NULL ,
		"TITLE_ID" NUMBER(10) CONSTRAINT "FLX_MEDIA_TITLE_ID_NN" NOT NULL ,
	CONSTRAINT "FLX_MEDIA_ID_PK" PRIMARY KEY ("MEDIA_ID")
		USING INDEX ENABLE
);

CREATE TABLE "RENTAL_HISTORY"
	("MEDIA_ID" NUMBER(10,0),
	"RENTAL_DATE" DATE DEFAULT SYSDATE,
	"CUSTOMER_ID" NUMBER(10,0) CONSTRAINT "FLX_RENT_HIST_CUST_ID_NN" NOT NULL,
	"RETURN_DATE" DATE,
	CONSTRAINT "FLX_RENT_HIST_ID_PK" PRIMARY KEY ("MEDIA_ID", "RENTAL_DATE")
);
	
	
--LLAVES FORANEAS
ALTER TABLE "STAR_BILLINGS" ADD CONSTRAINT "FLX_STBIL_TITLE_ID" FOREIGN KEY ("TITLE_ID")
    REFERENCES "MOVIES" ("TITLE_ID") ENABLE;
ALTER TABLE "STAR_BILLINGS" ADD CONSTRAINT "FLX_STBIL_ACTOR_ID" FOREIGN KEY ("ACTOR_ID")
    REFERENCES "ACTORS" ("ACTOR_ID") ENABLE;

ALTER TABLE "MEDIA" ADD CONSTRAINT "FLX_MEDIA_TITLE_ID" FOREIGN KEY ("TITLE_ID")
	REFERENCES "MOVIES" ("TITLE_ID") ENABLE;

ALTER TABLE "RENTAL_HISTORY" ADD CONSTRAINT "FLX_RENT_HIST_MEDIA_ID_FK" FOREIGN KEY ("MEDIA_ID")
	REFERENCES "MEDIA" ("MEDIA_ID") ENABLE;

ALTER TABLE "RENTAL_HISTORY" ADD CONSTRAINT "FLX_RENT_HIST_CUST_ID_FK" FOREIGN KEY ("CUSTOMER_ID")
	REFERENCES "CUSTOMERS" ("CUSTOMER_ID") ENABLE;

--SECUENCIAS
--Secuencia para CUSTOMER_ID tabla CUSTOMERS
CREATE SEQUENCE CUST_ID_SEQ
    INCREMENT BY 1
    START WITH 101;

--secuencia para title_id en movies
CREATE SEQUENCE MOVIES_SEQ
    INCREMENT BY 1
    START WITH 1;

--secuencia para MEDIA_ID en tabla MEDIA
CREATE SEQUENCE MEDIA_SEQ
    INCREMENT BY 1
    START WITH 92;

--secuencia para ACTOR_ID en tabla ACTOR
CREATE SEQUENCE ACTORS_SEQ
    INCREMENT BY 1
    START WITH 1001;
--select * from user_sequences;

--INDICES
--indice para tabla CUSTOMERS campo LAST_NAME
CREATE INDEX flx_cust_lname_idx
ON CUSTOMERS (LAST_NAME);

--select * from user_indexes;

--SINONIMOS 
--sinonimo para vista title_unavail
CREATE SYNONYM TU
FOR TITLE_UNAVAIL;






